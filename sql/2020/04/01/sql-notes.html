<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Sql Notes | Amy’s blog</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="Sql Notes">
<meta name="author" content="https://github.com/yeminyi">
<meta property="og:locale" content="en_US">
<meta name="description" content="Create a Table">
<meta property="og:description" content="Create a Table">
<link rel="canonical" href="https://yeminyi.github.io/myblog/sql/2020/04/01/sql-notes.html">
<meta property="og:url" content="https://yeminyi.github.io/myblog/sql/2020/04/01/sql-notes.html">
<meta property="og:site_name" content="Amy’s blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-04-01T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Sql Notes">
<script type="application/ld+json">
{"description":"Create a Table","url":"https://yeminyi.github.io/myblog/sql/2020/04/01/sql-notes.html","@type":"BlogPosting","headline":"Sql Notes","dateModified":"2020-04-01T00:00:00+00:00","datePublished":"2020-04-01T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://yeminyi.github.io/myblog/sql/2020/04/01/sql-notes.html"},"author":{"@type":"Person","name":"https://github.com/yeminyi"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
  <!-- and it's easy to individually load additional languages -->
  <script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>
  <link rel="stylesheet" href="/myblog/assets/css/main.css">
  <script src="/myblog/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="https://yeminyi.github.io/myblog/feed.xml" title="Amy's blog">
</head>
<body>



















<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/myblog/">
  <img class="site-favicon" title="Amy's blog" src="" onerror="this.style.display='none'">
  Amy's blog
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/myblog/">HOME</a><a class="page-link" href="/myblog/archives.html">ARCHIVES</a><a class="page-link" href="/myblog/categories.html">CATEGORIES</a><a class="page-link" href="/myblog/tags.html">TAGS</a><a class="page-link" href="/myblog/about.html">ABOUT</a>




<span class="page-link">

<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://www.countryflags.io/au/flat/64.png" title="">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://www.countryflags.io/cn/flat/64.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: '',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>










































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.matches('a')) {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Sql Notes</h1>
  <h3 class="post-subtitle"></h3>

  <p class="post-meta">
    <time class="dt-published" datetime="2020-04-01T00:00:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> 01 Apr 2020
    </time>

    





















    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 7 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/myblog/tags.html#sql">#sql</a><a class="post-tag" href="/myblog/tags.html#sqlserver">#sqlserver</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="create-a-table">Create a Table</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">------SQL Server：----</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">into</span> <span class="n">temp_Org_employee</span> <span class="k">from</span> <span class="n">org_employee</span>

<span class="c1">------excel import:----</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">INTO</span> <span class="o">#</span><span class="k">temp</span>
<span class="k">FROM</span> <span class="n">OPENROWSET</span><span class="p">(</span><span class="s1">'Microsoft.ACE.OLEDB.12.0'</span><span class="p">,</span>
<span class="s1">'Excel 12.0 Xml;HDR=YES;Database=C:</span><span class="se">\t</span><span class="s1">emp</span><span class="se">\*</span><span class="s1">*****.xlsx'</span><span class="p">,</span><span class="s1">'SELECT * FROM [sheet1$]'</span><span class="p">);</span>

</code></pre></div></div>
<h2 id="always-use">Always Use</h2>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">insert</span> <span class="k">into</span> <span class="k">table</span><span class="p">(</span><span class="n">field1</span><span class="p">,</span><span class="n">field2</span><span class="p">)</span> <span class="k">values</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">)</span>

<span class="k">delete</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="p">...</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="p">...</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="n">field</span> <span class="k">like</span> <span class="err">’</span><span class="o">%</span><span class="n">value</span><span class="o">%</span><span class="err">’</span>    

<span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">totalcount</span> <span class="k">from</span> <span class="k">table</span>

<span class="k">select</span> <span class="k">max</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">as</span> <span class="n">maxv</span> <span class="k">from</span> <span class="k">table</span>

<span class="k">select</span> <span class="k">min</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">as</span> <span class="n">minv</span> <span class="k">from</span> <span class="k">table</span>

<span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">as</span> <span class="n">sumv</span> <span class="k">from</span> <span class="k">table</span>

<span class="k">select</span> <span class="k">avg</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">as</span> <span class="n">avgv</span> <span class="k">from</span> <span class="k">table</span>

<span class="c1">---Order by 和 Group by:</span>

<span class="c1">---Order by按照条件来进行正序和逆序排序。</span>

<span class="c1">---根据group by中条件来分成若干组，然后进行统计，必须带分组统计函数：count,sum,max,min,avg等。</span>

<span class="c1">---where  1=1，1=2，1&lt;&gt;1</span>

<span class="c1">---“1=1” 是表示选择全部， “1=2”全部不选， “1&lt;&gt;1”全部不选</span>


<span class="c1">---- union all </span>
<span class="k">SELECT</span> <span class="s1">'GUID-EW83-4724-A454'</span><span class="p">,</span><span class="n">tabletemp</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="s1">'amy.ye@test.com'</span><span class="p">,</span><span class="n">GETDATE</span><span class="p">(),</span><span class="mi">1</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">select</span> <span class="s1">'temp1'</span> <span class="k">union</span> <span class="k">all</span> 
<span class="k">select</span> <span class="s1">'temp2'</span> <span class="k">union</span> <span class="k">all</span> 
<span class="k">select</span> <span class="s1">'temp3'</span><span class="p">)</span> <span class="n">tabletemp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">select</span> <span class="n">list</span><span class="p">.</span><span class="n">DangerWords</span> <span class="k">into</span> <span class="o">#</span><span class="n">tempdangerwords</span>
		<span class="k">FROM</span> <span class="p">(</span>
		<span class="k">select</span> <span class="s1">'bullying'</span> <span class="k">union</span> <span class="k">all</span> 
		<span class="k">select</span> <span class="s1">'bullied'</span> <span class="k">union</span> <span class="k">all</span>
		<span class="k">select</span> <span class="s1">'bully'</span>
		<span class="p">)</span> <span class="n">list</span> <span class="p">(</span><span class="n">DangerWords</span><span class="p">)</span>	
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span>  <span class="o">#</span><span class="n">tempdangerwords</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">---1、子查询(表名1：a 表名2：b)</span>

<span class="k">select</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="k">c</span> <span class="k">from</span> <span class="n">a</span> <span class="k">where</span> <span class="n">a</span> <span class="k">IN</span> <span class="p">(</span><span class="k">select</span> <span class="n">d</span> <span class="k">from</span> <span class="n">b</span> <span class="p">)</span> <span class="err">或</span> <span class="k">select</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="k">c</span> <span class="k">from</span> <span class="n">a</span> <span class="k">where</span> <span class="n">a</span> <span class="k">IN</span> <span class="p">(...)</span>

<span class="c1">--2、between,between查询数据范围内的结果集，查询数据范围时包括了边界值,not between不在数据范围内的结果集。</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="n">a</span> <span class="k">between</span> <span class="s1">'值1'</span> <span class="k">and</span>  <span class="s1">'值2'</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="n">a</span> <span class="k">not</span> <span class="k">between</span> <span class="err">‘数值</span><span class="mi">1</span><span class="err">‘</span> <span class="k">and</span> <span class="err">‘数值</span><span class="mi">2</span><span class="err">’</span>

<span class="c1">---3、in，表是在数据范围内的结果集， not in 反之。</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="n">a</span>  <span class="k">in</span> <span class="p">(</span><span class="err">‘值</span><span class="mi">1</span><span class="err">’</span><span class="p">,</span><span class="err">’值</span><span class="mi">2</span><span class="err">’</span><span class="p">,</span><span class="err">’值</span><span class="mi">3</span><span class="err">’</span><span class="p">,</span><span class="err">’值</span><span class="mi">4</span><span class="err">’</span><span class="p">,</span><span class="err">’值</span><span class="mi">5</span><span class="err">’</span><span class="p">)</span>

<span class="c1">---4、两张关联表，删除表1中已经在表2中没有的信息</span>

<span class="k">delete</span> <span class="k">from</span> <span class="n">table1</span> <span class="k">where</span> <span class="k">not</span> <span class="k">exists</span> <span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">table2</span> <span class="k">where</span> <span class="n">table1</span><span class="p">.</span><span class="n">field1</span><span class="o">=</span><span class="n">table2</span><span class="p">.</span><span class="n">field1</span> <span class="p">)</span>

<span class="c1">---5、多表内连接查询公共数据：</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">A</span>  <span class="k">join</span> <span class="n">B</span> <span class="k">on</span> <span class="n">A</span><span class="p">.</span><span class="n">a</span><span class="o">=</span><span class="n">B</span><span class="p">.</span><span class="n">a</span>  <span class="k">join</span> <span class="k">C</span> <span class="k">on</span> <span class="n">A</span><span class="p">.</span><span class="n">a</span><span class="o">=</span><span class="k">C</span><span class="p">.</span><span class="n">a</span> <span class="k">where</span><span class="p">...</span>

<span class="c1">---6、复制表(只复制表结构,源表名：a 新表名：b)</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">into</span> <span class="n">b</span> <span class="k">from</span> <span class="n">a</span> <span class="k">where</span> <span class="mi">1</span><span class="o">&lt;&gt;</span><span class="mi">1</span><span class="p">(</span><span class="err">仅用于</span><span class="k">SQL</span> <span class="n">Server</span><span class="p">)</span>

<span class="k">or</span>  <span class="k">select</span> <span class="n">top</span> <span class="mi">0</span> <span class="o">*</span> <span class="k">into</span> <span class="n">b</span> <span class="k">from</span> <span class="n">a</span>

<span class="c1">---7、拷贝表(拷贝数据,源表名：a 目标表名：b) </span>

<span class="k">insert</span> <span class="k">into</span> <span class="n">b</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="k">c</span><span class="p">)</span> <span class="k">select</span> <span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span> <span class="k">from</span> <span class="n">b</span><span class="p">;</span>

<span class="c1">---8、跨数据库之间表的拷贝(具体数据使用绝对路径) </span>

<span class="k">insert</span> <span class="k">into</span> <span class="n">b</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="k">c</span><span class="p">)</span> <span class="k">select</span> <span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span> <span class="k">from</span> <span class="n">bin</span> <span class="err">‘具体数据库’</span> <span class="k">where</span> <span class="p">...</span>

<span class="c1">---例子：..from b in'"&amp;Server.MapPath(".")&amp;"\data.mdb"&amp;"' where...</span>

<span class="c1">---9、前n条记录</span>

<span class="k">select</span> <span class="n">top</span> <span class="n">n</span> <span class="o">*</span> <span class="n">form</span> <span class="k">table</span> <span class="k">where</span><span class="p">...</span>

<span class="c1">---10、删除表或者表数据</span>

<span class="k">TRUNCATE</span> <span class="k">TABLE</span> <span class="n">tablename</span>  <span class="c1">--清空表，不留痕迹     Delete from TABLE tablename  --仅仅删除数据       drop tabel tablename --删除表，包括表结构</span>

<span class="c1">---11、选择从第m到第n条记录的结果集</span>

<span class="k">select</span> <span class="n">top</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="n">top</span> <span class="n">n</span> <span class="o">*</span> <span class="k">from</span> <span class="n">tablename</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="k">asc</span><span class="p">)</span>  <span class="k">table</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="k">desc</span>

<span class="c1">---12、随机选择记录</span>

<span class="k">select</span> <span class="n">newid</span><span class="p">()</span>

<span class="c1">---13、随机取出n条数据</span>

<span class="k">select</span> <span class="n">top</span> <span class="n">n</span> <span class="o">*</span> <span class="k">from</span> <span class="n">tablename</span> <span class="k">order</span> <span class="k">by</span> <span class="n">newid</span><span class="p">()</span>

<span class="c1">---14、删除重复记录，请用查询分析器分析性能开销！</span>

<span class="k">delete</span> <span class="k">from</span> <span class="n">tablename</span> <span class="k">where</span> <span class="n">id</span> <span class="k">not</span> <span class="k">in</span> <span class="p">(</span><span class="k">select</span> <span class="k">max</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">from</span> <span class="n">tablename</span> <span class="k">group</span> <span class="k">by</span> <span class="n">column1</span><span class="p">,</span><span class="n">column2</span><span class="p">,</span><span class="n">column3</span><span class="p">...)</span>

<span class="k">select</span> <span class="k">distinct</span> <span class="o">*</span> <span class="k">into</span> <span class="k">temp</span> <span class="k">from</span> <span class="n">tablename</span><span class="p">;</span>

<span class="k">delete</span> <span class="k">from</span> <span class="n">tablename</span><span class="p">;</span>

<span class="k">insert</span> <span class="k">into</span> <span class="n">tablename</span> <span class="k">select</span><span class="o">*</span> <span class="k">from</span> <span class="k">temp</span><span class="p">;</span>

<span class="c1">---15、case when then使用</span>

<span class="k">select</span> <span class="k">type</span><span class="p">,(</span><span class="k">case</span> <span class="n">columnname</span> <span class="k">when</span> <span class="s1">'xx'</span> <span class="k">then</span> <span class="s1">'oo'</span>  <span class="k">when</span> <span class="s1">'xxx'</span> <span class="k">then</span> <span class="s1">'ooo'</span> <span class="k">else</span> <span class="s1">'over'</span> <span class="k">end</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span>
</code></pre></div></div>
<h2 id="date-format">Date Format</h2>
<p>It is worth to note that the output of these date formats are of VARCHAR data types already and not of DATETIME data type.  With this in mind, any date comparisons performed after the datetime value has been formatted are using the VARCHAR value of the date and time and not its original DATETIME value.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-------convert----------</span>
<span class="k">SELECT</span> <span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">GETDATE</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">GETDATE</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span> <span class="k">AS</span> <span class="p">[</span><span class="n">MM</span><span class="o">/</span><span class="n">DD</span><span class="o">/</span><span class="n">YY</span><span class="p">]</span>
<span class="c1">--------format----------</span>
<span class="k">SELECT</span> <span class="n">FORMAT</span> <span class="p">(</span><span class="n">getdate</span><span class="p">(),</span> <span class="s1">'dd/MM/yyyy '</span><span class="p">)</span> <span class="k">as</span> <span class="nb">date</span>
<span class="k">SELECT</span> <span class="n">FORMAT</span> <span class="p">(</span><span class="n">getdate</span><span class="p">(),</span> <span class="s1">'MM-dd-yy'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">date</span>
<span class="c1">--------yesterday-------</span>
<span class="k">SELECT</span> <span class="k">cast</span><span class="p">(</span><span class="n">dateadd</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">getdate</span><span class="p">())</span> <span class="k">as</span> <span class="nb">date</span><span class="p">)</span>
</code></pre></div></div>
<p><a href="http://www.sql-server-helper.com/tips/date-formats.aspx">http://www.sql-server-helper.com/tips/date-formats.aspx</a></p>

<p><a href="https://www.mssqltips.com/sqlservertip/1145/date-and-time-conversions-using-sql-server/">https://www.mssqltips.com/sqlservertip/1145/date-and-time-conversions-using-sql-server/</a></p>
<h2 id="explicit-transactions">Explicit transactions</h2>

<p>When a DELETE or UPDATE statement it is recommanded to explicitly use BEGIN TRAN to make sure the statement is correct and you can get the correct number of results returned.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">begin</span> <span class="n">tran</span>

<span class="k">insert</span> <span class="k">into</span> <span class="n">tablename</span> <span class="k">values</span> <span class="p">(</span><span class="s1">'e@123.com.au'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">GETUTCDATE</span><span class="p">(),</span><span class="k">null</span><span class="p">)</span>

<span class="k">rollback</span> <span class="n">tran</span>


<span class="k">begin</span> <span class="n">tran</span>

<span class="k">update</span> <span class="n">tablelist</span> <span class="k">set</span> <span class="p">[</span><span class="k">To</span><span class="p">]</span><span class="o">=</span> <span class="k">REPLACE</span><span class="p">([</span><span class="k">To</span><span class="p">],</span><span class="s1">'123@example.com.au'</span><span class="p">,</span> <span class="s1">'456@example.com.au'</span><span class="p">)</span> <span class="k">where</span> <span class="p">(</span><span class="n">AreaCode</span> <span class="k">LIKE</span> <span class="s1">'W%'</span><span class="p">)</span>

<span class="k">rollback</span> <span class="n">tran</span>
</code></pre></div></div>
<h2 id="search-the-procs">Search the procs</h2>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">----search by name</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span>
       <span class="n">o</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Object_Name</span><span class="p">,</span>
       <span class="n">o</span><span class="p">.</span><span class="n">type_desc</span>
<span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">sql_modules</span> <span class="n">m</span>
       <span class="k">INNER</span> <span class="k">JOIN</span>
       <span class="n">sys</span><span class="p">.</span><span class="n">objects</span> <span class="n">o</span>
         <span class="k">ON</span> <span class="n">m</span><span class="p">.</span><span class="n">object_id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">WHERE</span> <span class="n">m</span><span class="p">.</span><span class="n">definition</span> <span class="k">Like</span> <span class="s1">'%Whatever%'</span><span class="p">;</span>

<span class="c1">------search the update procs</span>
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">create_date</span><span class="p">,</span> <span class="n">modify_date</span> 
<span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">objects</span>
<span class="k">WHERE</span> <span class="k">type</span> <span class="o">=</span> <span class="s1">'P'</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">modify_date</span> <span class="k">DESC</span>
</code></pre></div></div>

<h2 id="refer-the-link">Refer the Link</h2>
<p><a href="http://www.sql-server-helper.com/tips/date-formats.aspx">http://www.sql-server-helper.com/tips/date-formats.aspx</a></p>

<p><a href="https://www.w3schools.com/sql/">https://www.w3schools.com/sql/</a></p>

<p><a href="https://www.hocode.com/OrgTec/DB/0006.html">https://www.hocode.com/OrgTec/DB/0006.html</a></p>

<p><a href="https://www.mssqltips.com/sqlservertip/1145/date-and-time-conversions-using-sql-server/">https://www.mssqltips.com/sqlservertip/1145/date-and-time-conversions-using-sql-server/</a></p>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/myblog/angular/2019/10/19/angular-cli-useful-things.html" title="Angular CLI useful commands">Angular CLI useful commands</a><a class="next" href="/myblog/typescript/2020/04/05/typescript-notes-copy.html" title="TypeScript Notes-Basic Types">TypeScript Notes-Basic Types</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/myblog/restful/2019/08/12/summary-http-patch.html" title="TypeScript Notes-Basic Types">What is JSON Patch</a></li>
<li><a class="post-link" href="/myblog/angular/2020/09/10/angular-deployment-github.html" title="TypeScript Notes-Basic Types">Angular Apps Deployment to GitHub Pages</a></li>
<li><a class="post-link" href="/myblog/github/2020/09/20/github-jekyll-blog.html" title="TypeScript Notes-Basic Types">How to create your blog for free using Jekyll + Github pages...</a></li>
<li><a class="post-link" href="/myblog/identityserver4/2020/10/03/identityserver-postlogoutredirectUri.html" title="TypeScript Notes-Basic Types">PostLogoutRedirectUri always null in identity Server 4 with Angular OIDC client</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">In this article</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items=20) {
      var items = menuContent.firstChild.children;

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/myblog/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
      <div>Copyright © 1970-2020 @https://github.com/yeminyi</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/myblog/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
